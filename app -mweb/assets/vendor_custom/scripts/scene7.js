if("undefined"==typeof s7viewers)s7viewers={};else if("object"!=typeof s7viewers)throw new Error("Cannot initialize a root 's7viewers' package. s7viewers is not an object");s7viewers.BasicZoomViewer||(s7viewers.BasicZoomViewer=function(a){if(this.sdkBasePath=(window.location.protocol==='https:'?'https:':'http:')+"//s7d1.scene7.com/s7sdk/2.8/",this.containerId=null,this.params={},this.handlers=[],this.onInitFail=null,this.initializationComplete=!1,this.initCalled=!1,"object"==typeof a){if(a.containerId&&this.setContainerId(a.containerId),a.params)for(var b in a.params)a.params.hasOwnProperty(b)&&a.params.propertyIsEnumerable(b)&&this.setParam(b,a.params[b]);a.handlers&&this.setHandlers(a.handlers),a.localizedTexts&&this.setLocalizedTexts(a.localizedTexts)}},s7viewers.BasicZoomViewer.cssClassName="s7basiczoomviewer",s7viewers.BasicZoomViewer.prototype.setContainerId=function(a){this.containerId=a||null},s7viewers.BasicZoomViewer.prototype.getContentUrl=function(){var a="",b=null;b=document.scripts?document.scripts:document.getElementsByTagName("script");for(var c=0;c<b.length;c++){var d=/^\s*(http[s]?:\/\/[^\/]*)?(.*)(\/js\/BasicZoomViewer\.js)/.exec(b[c].getAttribute("src"));if(d&&4==d.length){"undefined"!=typeof d[1]&&(a=d[1]),a+=d[2];break}}return""!=a&&a.lastIndexOf("/")!=a.length-1&&(a+="/"),a},s7viewers.BasicZoomViewer.prototype.includeViewer=function(){function a(){function a(a,b){var c=document.getElementById(a).className.split(" ");-1==c.indexOf(b)&&(c[c.length]=b,document.getElementById(a).className=c.join(" "))}function b(a,b){var c=a*b,d=0;return d=21e4>=c?1:c>21e4&&92e4>=c?2:0}function c(a,c){var f,g=b(a,c);f=0==g?"s7size_large":1==g?"s7size_small":"s7size_medium",e(d.containerId,f)}function e(a,b){var c=document.getElementById(a);if(void 0!=c){c=c.className;var d,e=/^(.*)(s7size_small|s7size_medium|s7size_large)(.*)$/gi;d=c.match(e)?c.replace(e,"$1"+b+"$3"):c+" "+b,c!=d&&(document.getElementById(a).className=d)}}function f(a){var b=a.s7event.asset;if("ratio"==d.viewerMode){var c=b.items[0],e=c.width/c.height;d.container.setAspect(e)}d.zoomView.setItem(b.items[0]),null!=d.handlers.initComplete&&"function"==typeof d.handlers.initComplete&&d.handlers.initComplete()}function g(){d.container.isFullScreen()?(d.closeButton&&(d.closeButton.getObj().style.display="block"),d.container.cancelFullScreen()):(d.closeButton&&(d.closeButton.getObj().style.display="none"),d.container.requestFullScreen())}function h(a){d.closeButton&&(d.closeButton.getObj().style.display=d.container.isFullScreen()?"none":"block"),j(a.s7event.w,a.s7event.h),c(a.s7event.w,a.s7event.h)}function i(a){d.closeButton&&(d.closeButton.getObj().style.display=d.container.isFullScreen()?"none":"block"),j(a.s7event.w,a.s7event.h),d.fullScreenButton.setSelected(d.container.isFullScreen())}function j(a,b){d.zoomView.resize(a,b)}function k(){try{"firefox"!=s7sdk.browser.name?window.open(d.getContentUrl()+"s7sdkclose.html","_self"):window.close()}catch(a){s7sdk.Logger.log(s7sdk.Logger.WARN,"Cannot close the window")}}function l(a,b,c,e,f){d.appMeasurementBridge&&d.appMeasurementBridge.track(a,b,c,e,f),d.handlers.trackEvent&&d.handlers.trackEvent(a,b,c,e,f),"s7ComponentEvent"in window&&s7ComponentEvent(a,b,c,e,f)}"desktop"==s7sdk.browser.device.name&&d.s7params.push("ZoomView.singleclick","zoomReset"),"desktop"==s7sdk.browser.device.name&&d.s7params.push("ZoomView.doubleclick","reset"),"ontouchstart"in window?a(d.containerId,"s7touchinput"):a(d.containerId,"s7mouseinput");var m=document.getElementById(d.containerId),n=m.style.minHeight;m.style.minHeight="1px";var o=document.createElement("div");o.style.position="relative",o.style.width="100%",o.style.height="100%",m.appendChild(o);var p=o.offsetHeight;o.offsetHeight<=1&&(m.style.height="100%",p=o.offsetHeight),m.removeChild(o),m.style.minHeight=n,d.container=new s7sdk.common.Container(d.containerId,d.s7params,d.containerId+"_container");var q=!1;switch(d.s7params.get("responsive","auto")){case"fit":q=!1;break;case"constrain":q=!0;break;default:q=0==p}c(d.container.getWidth(),d.container.getHeight()),d.viewerMode=d.container.isFixedSize()?"fixed":q?"ratio":"free",d.mediaSet=new s7sdk.set.MediaSet(null,d.s7params,d.containerId+"_mediaSet"),d.trackingManager.attach(d.mediaSet),d.mediaSet.addEventListener(s7sdk.event.AssetEvent.NOTF_SET_PARSED,f,!1),d.container.addEventListener(s7sdk.event.ResizeEvent.COMPONENT_RESIZE,h,!1),d.container.addEventListener(s7sdk.event.ResizeEvent.FULLSCREEN_RESIZE,i,!1),d.zoomView=new s7sdk.image.ZoomView(d.containerId+"_container",d.s7params,d.containerId+"_zoomView"),d.trackingManager.attach(d.zoomView),d.zoomInButton=new s7sdk.common.ZoomInButton(d.containerId+"_container",d.s7params,d.containerId+"_zoomInButton"),d.zoomOutButton=new s7sdk.common.ZoomOutButton(d.containerId+"_container",d.s7params,d.containerId+"_zoomOutButton"),d.fullScreenButton=new s7sdk.common.FullScreenButton(d.containerId+"_container",d.s7params,d.containerId+"_fullScreenButton"),d.zoomResetButton=new s7sdk.common.ZoomResetButton(d.containerId+"_container",d.s7params,d.containerId+"_zoomResetButton"),("1"==d.s7params.get("closeButton","0")||"true"==d.s7params.get("closeButton","0").toLowerCase())&&(d.closeButton=new s7sdk.common.CloseButton(d.containerId+"_container",d.s7params,d.containerId+"_closeButton"),d.closeButton.addEventListener("click",k)),!d.container.isPopup()||d.container.isFixedSize()||d.container.supportsNativeFullScreen()||(d.fullScreenButton.getObj().style.display="none"),"ratio"==d.viewerMode&&(m.style.height="auto"),d.zoomInButton.addEventListener("click",function(){d.zoomView.zoomIn()}),d.zoomOutButton.addEventListener("click",function(){d.zoomView.zoomOut()}),d.fullScreenButton.addEventListener("click",g),d.zoomView.addEventListener(s7sdk.event.CapabilityStateEvent.NOTF_ZOOM_CAPABILITY_STATE,function(a){a.s7event.state.hasCapability(s7sdk.ZoomCapabilityState.ZOOM_IN)?d.zoomInButton.activate():d.zoomInButton.deactivate(),a.s7event.state.hasCapability(s7sdk.ZoomCapabilityState.ZOOM_OUT)?d.zoomOutButton.activate():d.zoomOutButton.deactivate(),a.s7event.state.hasCapability(s7sdk.ZoomCapabilityState.ZOOM_RESET)?d.zoomResetButton.activate():d.zoomResetButton.deactivate()}),d.zoomResetButton.addEventListener("click",function(){d.zoomView.zoomReset()}),d.trackingManager.setCallback(l),"function"==typeof AppMeasurementBridge&&(d.appMeasurementBridge=new AppMeasurementBridge),"desktop"!=s7sdk.browser.device.name&&(d.visibilityManagerZoom=new s7sdk.VisibilityManager,d.visibilityManagerZoom.reference(d.zoomView),d.visibilityManagerZoom.attach(d.closeButton),d.visibilityManagerZoom.attach(d.zoomInButton),d.visibilityManagerZoom.attach(d.zoomOutButton),d.visibilityManagerZoom.attach(d.zoomResetButton),(!d.notCustomSize||d.container.supportsNativeFullScreen())&&d.visibilityManagerZoom.attach(d.fullScreenButton))}s7sdk.Util.require("s7sdk.set.MediaSet"),s7sdk.Util.require("s7sdk.image.ZoomView"),s7sdk.Util.require("s7sdk.common.Button"),s7sdk.Util.require("s7sdk.common.Container"),this.trackingManager=new s7sdk.TrackingManager,this.s7params=new s7sdk.ParameterManager(null,null,{asset:"MediaSet.asset"},this.getContentUrl()+"BasicZoomViewer_light.css");var b="";this.s7params.params.config&&s7sdk.Util.isString(this.s7params.params.config)&&(b=",",b+=this.s7params.params.config.indexOf("/")>-1?this.s7params.params.config.split("/")[1]:this.s7params.params.config),this.s7params.setViewer("501,5.1.1"+b);for(var c in this.params)"localizedtexts"!=c?this.s7params.push(c,this.params[c]):this.s7params.setLocalizedTexts(this.params[c]);this.container=null,this.zoomView=null,this.zoomInButton=null,this.zoomOutButton=null,this.zoomResetButton=null,this.closeButton=null,this.mediaSet=null,this.fullScreenButton=null,this.visibilityManagerZoom=null,this.container=document.getElementById(this.containerId),""!=this.container.className?-1!=this.container.className.indexOf(s7viewers.BasicZoomViewer.cssClassName)||(this.container.className+=" "+s7viewers.BasicZoomViewer.cssClassName):this.container.className=s7viewers.BasicZoomViewer.cssClassName;var d=this;this.s7params.addEventListener(s7sdk.Event.SDK_READY,function(){d.initSiteCatalyst(d.s7params,a)},!1),this.s7params.init()},s7viewers.BasicZoomViewer.prototype.setParam=function(a,b){this.params[a]=b},s7viewers.BasicZoomViewer.prototype.setParams=function(a){for(var b=a.split("&"),c=0;c<b.length;c++){var d=b[c].split("=");d.length>1&&this.setParam(d[0],decodeURIComponent(b[c].split("=")[1]))}},s7viewers.BasicZoomViewer.prototype.s7sdkUtilsAvailable=function(){return"undefined"!=typeof s7sdk},s7viewers.BasicZoomViewer.prototype.init=function(){if(this.initCalled=!0,this.initializationComplete)return this;var a=!1,b=this.sdkBasePath+"js/s7sdk/utils/Utils.js",c=null;c=document.scripts?document.scripts:document.getElementsByTagName("script");for(var d=0;d<c.length;d++)if(c[d]&&null!=c[d].getAttribute("src")&&-1!=c[d].getAttribute("src").indexOf(b)){a=!0;break}if(this.s7sdkUtilsAvailable())s7sdk.Util.init(),this.includeViewer(),this.initializationComplete=!0;else if(!this.s7sdkUtilsAvailable()&&a)var e=this,f=setInterval(function(){e.s7sdkUtilsAvailable()&&(clearInterval(f),s7sdk.Util.init(),e.includeViewer(),e.initializationComplete=!0)},100);else{var g=document.createElement("script");g.setAttribute("language","javascript"),g.setAttribute("type","text/javascript"),g.setAttribute("src",b);var h=document.getElementsByTagName("head"),i=this;g.onload=g.onerror=function(){this.executed||(this.executed=!0,i.s7sdkUtilsAvailable()&&s7sdk.Util&&(s7sdk.Util.init(),i.includeViewer(),i.initializationComplete=!0))},g.onreadystatechange=function(){var a=this;("complete"==this.readyState||"loaded"==this.readyState)&&setTimeout(function(){a.onload(),a.onreadystatechange=null},0)},h[0].appendChild(g)}return this},s7viewers.BasicZoomViewer.prototype.getDomain=function(a){var b=/(^http[s]?:\/\/[^\/]+)/i.exec(a);return null==b?"":b[1]},s7viewers.BasicZoomViewer.prototype.setAsset=function(a){this.mediaSet?this.mediaSet.setAsset(a):this.setParam("asset",a)},s7viewers.BasicZoomViewer.prototype.setLocalizedTexts=function(a){this.s7params?this.s7params.setLocalizedTexts(a):this.setParam("localizedtexts",a)},s7viewers.BasicZoomViewer.prototype.initSiteCatalyst=function(a,b){var c=a.get("asset",null,"MediaSet").split(",")[0].split(":")[0],d=!1;if(-1!=c.indexOf("/")){var e=s7sdk.MediaSetParser.findCompanyNameInAsset(c),f=a.get("config2");if(d=""!=f&&"undefined"!=typeof f){var g=this.getContentUrl()+"../AppMeasurementBridge.jsp?company="+e+(""==f?"":"&preset="+f);a.get("serverurl",null)&&(g+="&isRoot="+a.get("serverurl"));var h=document.createElement("script");h.setAttribute("language","javascript"),h.setAttribute("type","text/javascript"),h.setAttribute("src",g);var i=document.getElementsByTagName("head");h.onload=h.onerror=function(){this.executed||(this.executed=!0,"function"==typeof b&&b())},h.onreadystatechange=function(){var a=this;("complete"==this.readyState||"loaded"==this.readyState)&&setTimeout(function(){a.onload(),a.onreadystatechange=null},0)},i[0].appendChild(h)}else"function"==typeof b&&b()}},s7viewers.BasicZoomViewer.prototype.getComponent=function(a){switch(a){case"container":return this.container||null;case"mediaSet":return this.mediaSet||null;case"zoomView":return this.zoomView||null;case"zoomInButton":return this.zoomInButton||null;case"zoomOutButton":return this.zoomOutButton||null;case"zoomResetButton":return this.zoomResetButton||null;case"fullScreenButton":return this.fullScreenButton||null;case"closeButton":return this.closeButton||null;default:return null}},s7viewers.BasicZoomViewer.prototype.setHandlers=function(a){if(!this.initCalled){this.handlers=[];for(var b in a)a.hasOwnProperty(b)&&"function"==typeof a[b]&&(this.handlers[b]=a[b])}});
